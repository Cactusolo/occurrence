USE ${hive_db};
CREATE TEMPORARY FUNCTION collectMediaTypes AS 'org.gbif.occurrence.hive.udf.CollectMediaTypesUDF';
CREATE TEMPORARY FUNCTION removeNulls AS 'org.gbif.occurrence.hive.udf.ArrayNullsRemoverGenericUDF'
CREATE TABLE IF NOT EXISTS occurrence_hdfs (gbifid INT,v_abstract STRING,v_accessrights STRING,v_accrualmethod STRING,v_accrualperiodicity STRING,v_accrualpolicy STRING,v_alternative STRING,v_audience STRING,v_available STRING,v_bibliographiccitation STRING,v_conformsto STRING,v_contributor STRING,v_coverage STRING,v_created STRING,v_creator STRING,v_date_ STRING,v_dateaccepted STRING,v_datecopyrighted STRING,v_datesubmitted STRING,v_description STRING,v_educationlevel STRING,v_extent STRING,v_format_ STRING,v_hasformat STRING,v_haspart STRING,v_hasversion STRING,v_identifier STRING,v_instructionalmethod STRING,v_isformatof STRING,v_ispartof STRING,v_isreferencedby STRING,v_isreplacedby STRING,v_isrequiredby STRING,v_isversionof STRING,v_issued STRING,v_language STRING,v_license STRING,v_mediator STRING,v_medium STRING,v_modified STRING,v_provenance STRING,v_publisher STRING,v_references STRING,v_relation STRING,v_replaces STRING,v_requires STRING,v_rights STRING,v_rightsholder STRING,v_source STRING,v_spatial STRING,v_subject STRING,v_tableofcontents STRING,v_temporal STRING,v_title STRING,v_type STRING,v_valid STRING,v_acceptednameusage STRING,v_acceptednameusageid STRING,v_associatedmedia STRING,v_associatedoccurrences STRING,v_associatedreferences STRING,v_associatedsequences STRING,v_associatedtaxa STRING,v_basisofrecord STRING,v_bed STRING,v_behavior STRING,v_catalognumber STRING,v_class STRING,v_collectioncode STRING,v_collectionid STRING,v_continent STRING,v_coordinateprecision STRING,v_coordinateuncertaintyinmeters STRING,v_country STRING,v_countrycode STRING,v_county STRING,v_datageneralizations STRING,v_datasetid STRING,v_datasetname STRING,v_dateidentified STRING,v_day STRING,v_decimallatitude STRING,v_decimallongitude STRING,v_disposition STRING,v_dynamicproperties STRING,v_earliestageorloweststage STRING,v_earliesteonorlowesteonothem STRING,v_earliestepochorlowestseries STRING,v_earliesteraorlowesterathem STRING,v_earliestperiodorlowestsystem STRING,v_enddayofyear STRING,v_establishmentmeans STRING,v_eventdate STRING,v_eventid STRING,v_eventremarks STRING,v_eventtime STRING,v_family STRING,v_fieldnotes STRING,v_fieldnumber STRING,v_footprintsrs STRING,v_footprintspatialfit STRING,v_footprintwkt STRING,v_formation STRING,v_genus STRING,v_geodeticdatum STRING,v_geologicalcontextid STRING,v_georeferenceddate STRING,v_georeferenceprotocol STRING,v_georeferenceremarks STRING,v_georeferencesources STRING,v_georeferenceverificationstatus STRING,v_georeferencedby STRING,v_group_ STRING,v_habitat STRING,v_higherclassification STRING,v_highergeography STRING,v_highergeographyid STRING,v_highestbiostratigraphiczone STRING,v_identificationid STRING,v_identificationqualifier STRING,v_identificationreferences STRING,v_identificationremarks STRING,v_identificationverificationstatus STRING,v_identifiedby STRING,v_individualcount STRING,v_individualid STRING,v_informationwithheld STRING,v_infraspecificepithet STRING,v_institutioncode STRING,v_institutionid STRING,v_island STRING,v_islandgroup STRING,v_kingdom STRING,v_latestageorhigheststage STRING,v_latesteonorhighesteonothem STRING,v_latestepochorhighestseries STRING,v_latesteraorhighesterathem STRING,v_latestperiodorhighestsystem STRING,v_lifestage STRING,v_lithostratigraphicterms STRING,v_locality STRING,v_locationaccordingto STRING,v_locationid STRING,v_locationremarks STRING,v_lowestbiostratigraphiczone STRING,v_materialsampleid STRING,v_maximumdepthinmeters STRING,v_maximumdistanceabovesurfaceinmeters STRING,v_maximumelevationinmeters STRING,v_member STRING,v_minimumdepthinmeters STRING,v_minimumdistanceabovesurfaceinmeters STRING,v_minimumelevationinmeters STRING,v_month STRING,v_municipality STRING,v_nameaccordingto STRING,v_nameaccordingtoid STRING,v_namepublishedin STRING,v_namepublishedinid STRING,v_namepublishedinyear STRING,v_nomenclaturalcode STRING,v_nomenclaturalstatus STRING,v_occurrencedetails STRING,v_occurrenceid STRING,v_occurrenceremarks STRING,v_occurrencestatus STRING,v_order_ STRING,v_originalnameusage STRING,v_originalnameusageid STRING,v_othercatalognumbers STRING,v_ownerinstitutioncode STRING,v_parentnameusage STRING,v_parentnameusageid STRING,v_phylum STRING,v_pointradiusspatialfit STRING,v_preparations STRING,v_previousidentifications STRING,v_recordnumber STRING,v_recordedby STRING,v_reproductivecondition STRING,v_samplingeffort STRING,v_samplingprotocol STRING,v_scientificname STRING,v_scientificnameauthorship STRING,v_scientificnameid STRING,v_sex STRING,v_specificepithet STRING,v_startdayofyear STRING,v_stateprovince STRING,v_subgenus STRING,v_taxonconceptid STRING,v_taxonid STRING,v_taxonrank STRING,v_taxonremarks STRING,v_taxonomicstatus STRING,v_typestatus STRING,v_verbatimcoordinatesystem STRING,v_verbatimcoordinates STRING,v_verbatimdepth STRING,v_verbatimelevation STRING,v_verbatimeventdate STRING,v_verbatimlatitude STRING,v_verbatimlocality STRING,v_verbatimlongitude STRING,v_verbatimsrs STRING,v_verbatimtaxonrank STRING,v_vernacularname STRING,v_waterbody STRING,v_year STRING,identifiercount INT,crawlid INT,fragmentcreated BIGINT,xmlschema STRING,publishingorgkey STRING,unitqualifier STRING,abstract STRING,accessrights STRING,accrualmethod STRING,accrualperiodicity STRING,accrualpolicy STRING,alternative STRING,audience STRING,available STRING,bibliographiccitation STRING,conformsto STRING,contributor STRING,coverage STRING,created STRING,creator STRING,date_ STRING,dateaccepted STRING,datecopyrighted STRING,datesubmitted STRING,description STRING,educationlevel STRING,extent STRING,format_ STRING,hasformat STRING,haspart STRING,hasversion STRING,identifier STRING,instructionalmethod STRING,isformatof STRING,ispartof STRING,isreferencedby STRING,isreplacedby STRING,isrequiredby STRING,isversionof STRING,issued STRING,language STRING,license STRING,mediator STRING,medium STRING,modified BIGINT,provenance STRING,publisher STRING,references STRING,relation STRING,replaces STRING,requires STRING,rights STRING,rightsholder STRING,source STRING,spatial STRING,subject STRING,tableofcontents STRING,temporal STRING,title STRING,type STRING,valid STRING,acceptednameusage STRING,acceptednameusageid STRING,associatedoccurrences STRING,associatedreferences STRING,associatedsequences STRING,associatedtaxa STRING,basisofrecord STRING,bed STRING,behavior STRING,catalognumber STRING,class STRING,collectioncode STRING,collectionid STRING,continent STRING,countrycode STRING,county STRING,datageneralizations STRING,datasetid STRING,datasetname STRING,dateidentified BIGINT,day INT,decimallatitude DOUBLE,decimallongitude DOUBLE,disposition STRING,dynamicproperties STRING,earliestageorloweststage STRING,earliesteonorlowesteonothem STRING,earliestepochorlowestseries STRING,earliesteraorlowesterathem STRING,earliestperiodorlowestsystem STRING,enddayofyear STRING,establishmentmeans STRING,eventdate BIGINT,eventid STRING,eventremarks STRING,eventtime STRING,family STRING,fieldnotes STRING,fieldnumber STRING,footprintsrs STRING,footprintspatialfit STRING,footprintwkt STRING,formation STRING,genus STRING,geodeticdatum STRING,geologicalcontextid STRING,georeferenceddate STRING,georeferenceprotocol STRING,georeferenceremarks STRING,georeferencesources STRING,georeferenceverificationstatus STRING,georeferencedby STRING,group_ STRING,habitat STRING,higherclassification STRING,highergeography STRING,highergeographyid STRING,highestbiostratigraphiczone STRING,identificationid STRING,identificationqualifier STRING,identificationreferences STRING,identificationremarks STRING,identificationverificationstatus STRING,identifiedby STRING,individualcount STRING,individualid STRING,informationwithheld STRING,infraspecificepithet STRING,institutioncode STRING,institutionid STRING,island STRING,islandgroup STRING,kingdom STRING,latestageorhigheststage STRING,latesteonorhighesteonothem STRING,latestepochorhighestseries STRING,latesteraorhighesterathem STRING,latestperiodorhighestsystem STRING,lifestage STRING,lithostratigraphicterms STRING,locality STRING,locationaccordingto STRING,locationid STRING,locationremarks STRING,lowestbiostratigraphiczone STRING,materialsampleid STRING,maximumdistanceabovesurfaceinmeters STRING,member STRING,minimumdistanceabovesurfaceinmeters STRING,month INT,municipality STRING,nameaccordingto STRING,nameaccordingtoid STRING,namepublishedin STRING,namepublishedinid STRING,namepublishedinyear STRING,nomenclaturalcode STRING,nomenclaturalstatus STRING,occurrencedetails STRING,occurrenceid STRING,occurrenceremarks STRING,occurrencestatus STRING,order_ STRING,originalnameusage STRING,originalnameusageid STRING,othercatalognumbers STRING,ownerinstitutioncode STRING,parentnameusage STRING,parentnameusageid STRING,phylum STRING,pointradiusspatialfit STRING,preparations STRING,previousidentifications STRING,recordnumber STRING,recordedby STRING,reproductivecondition STRING,samplingeffort STRING,samplingprotocol STRING,scientificname STRING,scientificnameid STRING,sex STRING,specificepithet STRING,startdayofyear STRING,stateprovince STRING,subgenus STRING,taxonconceptid STRING,taxonid STRING,taxonrank STRING,taxonremarks STRING,taxonomicstatus STRING,typestatus STRING,verbatimcoordinatesystem STRING,verbatimcoordinates STRING,verbatimdepth STRING,verbatimelevation STRING,verbatimeventdate STRING,verbatimlocality STRING,verbatimsrs STRING,verbatimtaxonrank STRING,vernacularname STRING,waterbody STRING,year INT,datasetkey STRING,publishingcountry STRING,lastinterpreted BIGINT,coordinateaccuracy DOUBLE,elevation DOUBLE,elevationaccuracy DOUBLE,depth DOUBLE,depthaccuracy DOUBLE,distanceabovesurface STRING,distanceabovesurfaceaccuracy STRING,issue ARRAY<STRING>,hascoordinate BOOLEAN,hasgeospatialissues BOOLEAN,taxonkey INT,kingdomkey INT,phylumkey INT,classkey INT,orderkey INT,familykey INT,genuskey INT,subgenuskey INT,specieskey INT,species STRING,genericname STRING,typifiedname STRING,protocol STRING,lastparsed BIGINT,lastcrawled BIGINT,mediatype ARRAY<STRING>) STORED AS RCFILE;
INSERT OVERWRITE TABLE occurrence_hdfs SELECT occ.gbifid,v_abstract,v_accessrights,v_accrualmethod,v_accrualperiodicity,v_accrualpolicy,v_alternative,v_audience,v_available,v_bibliographiccitation,v_conformsto,v_contributor,v_coverage,v_created,v_creator,v_date_,v_dateaccepted,v_datecopyrighted,v_datesubmitted,v_description,v_educationlevel,v_extent,v_format_,v_hasformat,v_haspart,v_hasversion,v_identifier,v_instructionalmethod,v_isformatof,v_ispartof,v_isreferencedby,v_isreplacedby,v_isrequiredby,v_isversionof,v_issued,v_language,v_license,v_mediator,v_medium,v_modified,v_provenance,v_publisher,v_references,v_relation,v_replaces,v_requires,v_rights,v_rightsholder,v_source,v_spatial,v_subject,v_tableofcontents,v_temporal,v_title,v_type,v_valid,v_acceptednameusage,v_acceptednameusageid,v_associatedmedia,v_associatedoccurrences,v_associatedreferences,v_associatedsequences,v_associatedtaxa,v_basisofrecord,v_bed,v_behavior,v_catalognumber,v_class,v_collectioncode,v_collectionid,v_continent,v_coordinateprecision,v_coordinateuncertaintyinmeters,v_country,v_countrycode,v_county,v_datageneralizations,v_datasetid,v_datasetname,v_dateidentified,v_day,v_decimallatitude,v_decimallongitude,v_disposition,v_dynamicproperties,v_earliestageorloweststage,v_earliesteonorlowesteonothem,v_earliestepochorlowestseries,v_earliesteraorlowesterathem,v_earliestperiodorlowestsystem,v_enddayofyear,v_establishmentmeans,v_eventdate,v_eventid,v_eventremarks,v_eventtime,v_family,v_fieldnotes,v_fieldnumber,v_footprintsrs,v_footprintspatialfit,v_footprintwkt,v_formation,v_genus,v_geodeticdatum,v_geologicalcontextid,v_georeferenceddate,v_georeferenceprotocol,v_georeferenceremarks,v_georeferencesources,v_georeferenceverificationstatus,v_georeferencedby,v_group_,v_habitat,v_higherclassification,v_highergeography,v_highergeographyid,v_highestbiostratigraphiczone,v_identificationid,v_identificationqualifier,v_identificationreferences,v_identificationremarks,v_identificationverificationstatus,v_identifiedby,v_individualcount,v_individualid,v_informationwithheld,v_infraspecificepithet,v_institutioncode,v_institutionid,v_island,v_islandgroup,v_kingdom,v_latestageorhigheststage,v_latesteonorhighesteonothem,v_latestepochorhighestseries,v_latesteraorhighesterathem,v_latestperiodorhighestsystem,v_lifestage,v_lithostratigraphicterms,v_locality,v_locationaccordingto,v_locationid,v_locationremarks,v_lowestbiostratigraphiczone,v_materialsampleid,v_maximumdepthinmeters,v_maximumdistanceabovesurfaceinmeters,v_maximumelevationinmeters,v_member,v_minimumdepthinmeters,v_minimumdistanceabovesurfaceinmeters,v_minimumelevationinmeters,v_month,v_municipality,v_nameaccordingto,v_nameaccordingtoid,v_namepublishedin,v_namepublishedinid,v_namepublishedinyear,v_nomenclaturalcode,v_nomenclaturalstatus,v_occurrencedetails,v_occurrenceid,v_occurrenceremarks,v_occurrencestatus,v_order_,v_originalnameusage,v_originalnameusageid,v_othercatalognumbers,v_ownerinstitutioncode,v_parentnameusage,v_parentnameusageid,v_phylum,v_pointradiusspatialfit,v_preparations,v_previousidentifications,v_recordnumber,v_recordedby,v_reproductivecondition,v_samplingeffort,v_samplingprotocol,v_scientificname,v_scientificnameauthorship,v_scientificnameid,v_sex,v_specificepithet,v_startdayofyear,v_stateprovince,v_subgenus,v_taxonconceptid,v_taxonid,v_taxonrank,v_taxonremarks,v_taxonomicstatus,v_typestatus,v_verbatimcoordinatesystem,v_verbatimcoordinates,v_verbatimdepth,v_verbatimelevation,v_verbatimeventdate,v_verbatimlatitude,v_verbatimlocality,v_verbatimlongitude,v_verbatimsrs,v_verbatimtaxonrank,v_vernacularname,v_waterbody,v_year,identifiercount,crawlid,fragmentcreated,xmlschema,publishingorgkey,unitqualifier,abstract,accessrights,accrualmethod,accrualperiodicity,accrualpolicy,alternative,audience,available,bibliographiccitation,conformsto,contributor,coverage,created,creator,date_,dateaccepted,datecopyrighted,datesubmitted,description,educationlevel,extent,format_,hasformat,haspart,hasversion,identifier,instructionalmethod,isformatof,ispartof,isreferencedby,isreplacedby,isrequiredby,isversionof,issued,language,license,mediator,medium,modified,provenance,publisher,references,relation,replaces,requires,rights,rightsholder,source,spatial,subject,tableofcontents,temporal,title,type,valid,acceptednameusage,acceptednameusageid,associatedoccurrences,associatedreferences,associatedsequences,associatedtaxa,basisofrecord,bed,behavior,catalognumber,class,collectioncode,collectionid,continent,countrycode,county,datageneralizations,datasetid,datasetname,dateidentified,day,decimallatitude,decimallongitude,disposition,dynamicproperties,earliestageorloweststage,earliesteonorlowesteonothem,earliestepochorlowestseries,earliesteraorlowesterathem,earliestperiodorlowestsystem,enddayofyear,establishmentmeans,eventdate,eventid,eventremarks,eventtime,family,fieldnotes,fieldnumber,footprintsrs,footprintspatialfit,footprintwkt,formation,genus,geodeticdatum,geologicalcontextid,georeferenceddate,georeferenceprotocol,georeferenceremarks,georeferencesources,georeferenceverificationstatus,georeferencedby,group_,habitat,higherclassification,highergeography,highergeographyid,highestbiostratigraphiczone,identificationid,identificationqualifier,identificationreferences,identificationremarks,identificationverificationstatus,identifiedby,individualcount,individualid,informationwithheld,infraspecificepithet,institutioncode,institutionid,island,islandgroup,kingdom,latestageorhigheststage,latesteonorhighesteonothem,latestepochorhighestseries,latesteraorhighesterathem,latestperiodorhighestsystem,lifestage,lithostratigraphicterms,locality,locationaccordingto,locationid,locationremarks,lowestbiostratigraphiczone,materialsampleid,maximumdistanceabovesurfaceinmeters,member,minimumdistanceabovesurfaceinmeters,month,municipality,nameaccordingto,nameaccordingtoid,namepublishedin,namepublishedinid,namepublishedinyear,nomenclaturalcode,nomenclaturalstatus,occurrencedetails,occurrenceid,occurrenceremarks,occurrencestatus,order_,originalnameusage,originalnameusageid,othercatalognumbers,ownerinstitutioncode,parentnameusage,parentnameusageid,phylum,pointradiusspatialfit,preparations,previousidentifications,recordnumber,recordedby,reproductivecondition,samplingeffort,samplingprotocol,scientificname,scientificnameid,sex,specificepithet,startdayofyear,stateprovince,subgenus,taxonconceptid,taxonid,taxonrank,taxonremarks,taxonomicstatus,typestatus,verbatimcoordinatesystem,verbatimcoordinates,verbatimdepth,verbatimelevation,verbatimeventdate,verbatimlocality,verbatimsrs,verbatimtaxonrank,vernacularname,waterbody,year,datasetkey,publishingcountry,lastinterpreted,coordinateaccuracy,elevation,elevationaccuracy,depth,depthaccuracy,distanceabovesurface,distanceabovesurfaceaccuracy,removeNulls(array(CASE COALESCE(zero_coordinate,0) WHEN 0 THEN NULL ELSE 'ZERO_COORDINATE' END,CASE COALESCE(coordinates_out_of_range,0) WHEN 0 THEN NULL ELSE 'COORDINATES_OUT_OF_RANGE' END,CASE COALESCE(country_coordinate_mismatch,0) WHEN 0 THEN NULL ELSE 'COUNTRY_COORDINATE_MISMATCH' END,CASE COALESCE(country_mismatch,0) WHEN 0 THEN NULL ELSE 'COUNTRY_MISMATCH' END,CASE COALESCE(country_invalid,0) WHEN 0 THEN NULL ELSE 'COUNTRY_INVALID' END,CASE COALESCE(country_derived_from_coordinates,0) WHEN 0 THEN NULL ELSE 'COUNTRY_DERIVED_FROM_COORDINATES' END,CASE COALESCE(continent_country_mismatch,0) WHEN 0 THEN NULL ELSE 'CONTINENT_COUNTRY_MISMATCH' END,CASE COALESCE(continent_invalid,0) WHEN 0 THEN NULL ELSE 'CONTINENT_INVALID' END,CASE COALESCE(continent_derived_from_coordinates,0) WHEN 0 THEN NULL ELSE 'CONTINENT_DERIVED_FROM_COORDINATES' END,CASE COALESCE(presumed_swapped_coordinate,0) WHEN 0 THEN NULL ELSE 'PRESUMED_SWAPPED_COORDINATE' END,CASE COALESCE(presumed_negated_longitude,0) WHEN 0 THEN NULL ELSE 'PRESUMED_NEGATED_LONGITUDE' END,CASE COALESCE(presumed_negated_latitude,0) WHEN 0 THEN NULL ELSE 'PRESUMED_NEGATED_LATITUDE' END,CASE COALESCE(recorded_date_mismatch,0) WHEN 0 THEN NULL ELSE 'RECORDED_DATE_MISMATCH' END,CASE COALESCE(recorded_date_invalid,0) WHEN 0 THEN NULL ELSE 'RECORDED_DATE_INVALID' END,CASE COALESCE(recorded_year_unlikely,0) WHEN 0 THEN NULL ELSE 'RECORDED_YEAR_UNLIKELY' END,CASE COALESCE(taxon_match_fuzzy,0) WHEN 0 THEN NULL ELSE 'TAXON_MATCH_FUZZY' END,CASE COALESCE(taxon_match_higherrank,0) WHEN 0 THEN NULL ELSE 'TAXON_MATCH_HIGHERRANK' END,CASE COALESCE(taxon_match_none,0) WHEN 0 THEN NULL ELSE 'TAXON_MATCH_NONE' END,CASE COALESCE(depth_not_metric,0) WHEN 0 THEN NULL ELSE 'DEPTH_NOT_METRIC' END,CASE COALESCE(depth_unlikely,0) WHEN 0 THEN NULL ELSE 'DEPTH_UNLIKELY' END,CASE COALESCE(depth_min_max_swapped,0) WHEN 0 THEN NULL ELSE 'DEPTH_MIN_MAX_SWAPPED' END,CASE COALESCE(depth_non_numeric,0) WHEN 0 THEN NULL ELSE 'DEPTH_NON_NUMERIC' END,CASE COALESCE(elevation_unlikely,0) WHEN 0 THEN NULL ELSE 'ELEVATION_UNLIKELY' END,CASE COALESCE(elevation_min_max_swapped,0) WHEN 0 THEN NULL ELSE 'ELEVATION_MIN_MAX_SWAPPED' END,CASE COALESCE(elevation_not_metric,0) WHEN 0 THEN NULL ELSE 'ELEVATION_NOT_METRIC' END,CASE COALESCE(elevation_non_numeric,0) WHEN 0 THEN NULL ELSE 'ELEVATION_NON_NUMERIC' END,CASE COALESCE(modified_date_invalid,0) WHEN 0 THEN NULL ELSE 'MODIFIED_DATE_INVALID' END,CASE COALESCE(modified_date_unlikely,0) WHEN 0 THEN NULL ELSE 'MODIFIED_DATE_UNLIKELY' END,CASE COALESCE(identified_date_unlikely,0) WHEN 0 THEN NULL ELSE 'IDENTIFIED_DATE_UNLIKELY' END,CASE COALESCE(identified_date_invalid,0) WHEN 0 THEN NULL ELSE 'IDENTIFIED_DATE_INVALID' END,CASE COALESCE(basis_of_record_invalid,0) WHEN 0 THEN NULL ELSE 'BASIS_OF_RECORD_INVALID' END,CASE COALESCE(type_status_invalid,0) WHEN 0 THEN NULL ELSE 'TYPE_STATUS_INVALID' END,CASE COALESCE(multimedia_date_invalid,0) WHEN 0 THEN NULL ELSE 'MULTIMEDIA_DATE_INVALID' END,CASE COALESCE(multimedia_uri_invalid,0) WHEN 0 THEN NULL ELSE 'MULTIMEDIA_URI_INVALID' END)),(decimalLongitude IS NOT NULL AND decimalLatitude IS NOT NULL),(COALESCE(zero_coordinate,0) + COALESCE(coordinates_out_of_range,0) + COALESCE(country_coordinate_mismatch,0) + COALESCE(presumed_swapped_coordinate,0) + COALESCE(presumed_negated_latitude,0) + COALESCE(presumed_negated_longitude,0)) > 0,taxonkey,kingdomkey,phylumkey,classkey,orderkey,familykey,genuskey,subgenuskey,specieskey,species,genericname,typifiedname,protocol,lastparsed,lastcrawled,collectMediaTypes(ext_multimedia) FROM occurrence_hbase occ LEFT OUTER JOIN occurrence_multimedia_hbase mm ON occ.gbifid = mm.gbifid;
